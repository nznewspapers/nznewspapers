---
layout: layout.njk
permalink: places/index.html
eleventyComputed:
  title: "{{ stats.count }} Newspapers from {{ stats.districts }} districts in {{ stats.regions }} regions"
---

{% from "macros.njk" import newspaperLine %}

<script>
    // Handle legacy query params
    const params = new URLSearchParams(window.location.search);
    const mode = params.get('mode');
    const place = params.get('place');
    
    if (mode === 'digitised') {
        window.location.replace('/digitised/');
    } else if (mode === 'current') {
        window.location.replace('/current/');
    } else if (place) {
        // Redirect ?place=Auckland to the new place page
        const slug = place.toLowerCase().trim().replace(/[^\w\s-]/g, '').replace(/[\s_-]+/g, '-').replace(/^-+|-+$/g, '');
        window.location.replace('/place/' + slug + '/');
    }
</script>

<div class="multicolumnbox">
    {% for regionObj in places.all %}
        <div class="columnheading">{{ regionObj.name }}</div>
        
        {% for districtObj in regionObj.districts %}
             <div class="columnsubheading">{{ districtObj.name }}</div>
             {% for paper in districtObj.papers %}
                {{ newspaperLine(paper) }}
             {% endfor %}
        {% endfor %}
    {% endfor %}
</div>
